<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>signet default loader &mdash; signet  documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="signet  documentation" href="index.html" />
    <link rel="up" title="signet package" href="signet.html" />
    <link rel="prev" title="sign_code - Digially sign code" href="signet.command.sign_code.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="signet.command.sign_code.html" title="sign_code - Digially sign code"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">signet  documentation</a> &raquo;</li>
          <li><a href="signet.html" accesskey="U">signet package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="signet-default-loader">
<h1>signet default loader<a class="headerlink" href="#signet-default-loader" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="signet.command.build_signet.html#module-signet.command.build_signet" title="signet.command.build_signet: Create a signet loader for a python script."><tt class="xref py py-mod docutils literal"><span class="pre">signet</span></tt></a> comes with a default loader written in c++. The
heirarchy for the loader is:</p>
<div class="highlight-python"><div class="highlight"><pre>signet.command/
|-- lib/
|   |-- sha1.cpp            -- sha1 calculator
|   |-- sha1.h
|   |-- verifytrust.cpp     -- windows pe verifier
|   |-- verifytrust.h
|
|-- static/
|   |-- app.ico             -- windows default icon
|
|-- templates/
|   |-- loader.cpp          -- loader c++ code
|   |-- loader.h
</pre></div>
</div>
<p>signet comes with two library modules, <em>sha1</em> and <em>verifytrust</em>.  The <em>sha1</em> module provides
an open source sha1 calculator. It&#8217;s inclusion removes the dependency of bundling openssl
with your loader. The <em>verifytrust</em> modules provides windows pe verification.</p>
<div class="section" id="how-it-works">
<h2>How It works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>The default loader is a two pass system, with each pass creating a separate
instance of python.  The first pass performs verification, and the second pass
runs the target script.</p>
<p>The two pass architecture was to solve the fact that the loader wants to scan
the modules in alphabectical order (which is required for security). But
importing modules alphabetically does not allow modules to initialize
themselves in the way their designers may have intended. So after the first
pass finishes validation, we finalize the fist pass python and initialize an
new instance.</p>
<div class="section" id="import-side-effects">
<h3>Import Side-effects<a class="headerlink" href="#import-side-effects" title="Permalink to this headline">¶</a></h3>
<p>The two pass solution has one draw back, namely <em>import sidee-ffects</em>. First, let me
say <strong>import sideeffects are evil</strong> ! Imported code should stick to strictly initializing
its internal state. Imported code should NOT connect to databases, the Internet, make
changes to the filesystem nor should it output to the console. Code that needs to do
these things should wait until the user specifically requests initialization.</p>
<p>If your code has import side-effects, then it&#8217;s up to you to make sure the side-effects
are harmless during signet&#8217;s pass one validation phase. At a minimum, you need to ensure
it&#8217;s safe to run these side-effects twice.</p>
</div>
</div>
<div class="section" id="builder-dependencies">
<h2>Builder Dependencies<a class="headerlink" href="#builder-dependencies" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="sha1-calculations">
<h2>SHA1 Calculations<a class="headerlink" href="#sha1-calculations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="command-line-options">
<h2>Command Line Options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h2>
<p>Explain loader command line &#8216;&#8211;SECURITY*&#8217;, and pass through</p>
</div>
<div class="section" id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Notify &#8216;SIGNET=1&#8217; environment</p>
</div>
<div class="section" id="pe-verifications-winverifytrust">
<h2>PE Verifications &amp; WinVerifyTrust<a class="headerlink" href="#pe-verifications-winverifytrust" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">signet default loader</a><ul>
<li><a class="reference internal" href="#how-it-works">How It works</a><ul>
<li><a class="reference internal" href="#import-side-effects">Import Side-effects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#builder-dependencies">Builder Dependencies</a></li>
<li><a class="reference internal" href="#sha1-calculations">SHA1 Calculations</a></li>
<li><a class="reference internal" href="#command-line-options">Command Line Options</a></li>
<li><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li><a class="reference internal" href="#pe-verifications-winverifytrust">PE Verifications &amp; WinVerifyTrust</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="signet.command.sign_code.html"
                        title="previous chapter"><tt class="docutils literal"><span class="pre">sign_code</span></tt> - Digially sign code</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/loader.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="signet.command.sign_code.html" title="sign_code - Digially sign code"
             >previous</a> |</li>
        <li><a href="index.html">signet  documentation</a> &raquo;</li>
          <li><a href="signet.html" >signet package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Author.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>